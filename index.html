<!doctype html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trivia Game</title>
    <!-- Added link to the jQuery Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Reset CSS -->
    <link rel="stylesheet" type="text/css" href="./assets/css/reset.css">
    <!-- Added a link to Bootstrap-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>

<style>

.centered-text {
    text-align:center
}

</style>

<body>
    <div class="centered-text" id="header"><h1>Trivia Game</h1></div>

    <container id=container>

    <div class="centered-text" id="question">Question</div>
    
    <div class="row">

        <div class="col-sm-2"></div>

        <div class="col-sm-4">
            <div class="centered-text">
                <div class="answer" id="option-0" data-value=true>Option 1</div>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="centered-text">
                <div class="answer" id="option-1" data-value=false>Option 2</div>
            </div>
        </div>

        <div class="col-sm-2"></div>


    </div>

    <div class="row">

        <div class="col-sm-2"></div>

        <div class="col-sm-4">
            <div class="centered-text">
                <div class="answer" id="option-2" data-value=false>Option 3</div>
            </div>
        </div>
    
        <div class="col-sm-4">
            <div class="centered-text">
                <div class="answer" id="option-3" data-value=false>Option 4</div>
            </div>
        </div>

        <div class="col-sm-2"></div>
        
    </div>

    <div class="row">

        <div class="col-sm-2"></div>

        <div class="col-sm-8">
            <div class="centered-text" id="counter"></div>
        </div>

        <div class="col-sm-2"></div>

    </div>

    </container>

    <container id = "container-results">

        <div class="row">

                <div class="col-sm-2"></div>
    
                <div class="col-sm-4">
                    <div class="centered-text">
                        <div id="right"></div>
                    </div>
                </div>
        
                <div class="col-sm-4">
                    <div class="centered-text">
                        <div id="wrong"></div>
                    </div>
                </div>
    
                <div class="col-sm-2"></div>
            
        </div>

        <div class="centered-text" id="results-timer"></div>

    </container>


    <script>

        var trivQuestion = [
            quest1 = {
                question: "question 1",
                answers: ["right", "wrong", "wrong", "wrong"],
            },
            quest2 = {
                question: "question 2",
                answers: ["right", "wrong", "wrong", "wrong"],
            },
            quest3 = {
                question: "question 3",
                answers: ["right", "wrong", "wrong", "wrong"],
            },
            quest4 = {
                question: "question 4",
                answers: ["right", "wrong", "wrong", "wrong"],
            },
            quest5 = {
                question: "question 5",
                answers: ["right", "wrong", "wrong", "wrong"],
            }
        ]

        var timerCount = 10;
        var resetCount = 10;
        var questCount = 0;
        var disArrayCount = 0;
        var wins = 0;
        var losses = 0;
        var trivTimer
        var countTimer
        var gameResetTimer
        var countResetTimer
        var clockRunning = false;
        var gameOver = false;
        var displayArray = [0, 1, 2, 3]
        var container
        var containerResults

        //Done defining variables

        function shuffleArray(array) {  //used to shuffle the array of answers
            for (var i = array.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
        }

        function questionDisplay(num) {
            $("#question").text(trivQuestion[num].question);
            shuffleArray(displayArray);
            displayArray.forEach(function(str) {
                console.log(str);
            })
            displayArray.forEach(function(str) {
                $("#option-"+ str).text(trivQuestion[num].answers[disArrayCount])
                if (disArrayCount === 0) {
                    $("#option-" + str).attr("data-value", true);
                } else {
                    $("#option-"+ str).attr("data-value", false);
                }

                disArrayCount++;
            })
            disArrayCount = 0;

            timerStart();
        }


        function counter() {
            timerCount--;
            // console.log(timerCount);
            $("#counter").text(timerCount);
        }

        function resetCounter() {
            resetCount--
            $("#results-timer").text("Time until next game: " + resetCount);
        }

        function timerStart() {
            if (clockRunning) {
                return;
            }

            trivTimer = setTimeout(timeUp, timerCount*1000);
            countTimer = setInterval(counter, 1000);
            $("#counter").text(timerCount);
            clockRunning = true;
        }
        
        function timerReset() {
            timerCount = 10;

            if (!clockRunning) {
                return;
            }

            clearInterval(countTimer);
            clearTimeout(trivTimer);
            clockRunning = false;
        }

        function next() {
            questCount++;
            timerReset();

            if (questCount >= 5) {
                results();
                gameOver = true;
                return;
            }

            questionDisplay(questCount);
            timerStart();

        }

        function timeUp() {
            losses++;
            next();
        }

        function answer() {
            console.log($(this).attr("data-value"));

            if ($(this).attr("data-value") == "true") {
                wins++;
                console.log("wins " + wins);
            } 
            
            else {
                losses++;
                console.log("losses " + losses);
            }
            next();
        }

        function gameStart() {
            containerResults = $("#container-results").detach();
            questionDisplay(questCount);
        }

        function results() {
            container = $("#container").detach();
            $("#header").append(containerResults);
            $("#right").text("Answers right: " + wins);
            $("#wrong").text("Answers wrong: " + losses);
            gameOver = true;

            gameResetTimer = setTimeout(reset, 10000);
            countResetTimer = setInterval(resetCounter, 1000);
            $("#results-timer").text("Time until next game: " + resetCount);
        }

        //Need to add reset function

        function reset() {
            clearTimeout(gameResetTimer);
            clearTimeout(countResetTimer);
            containerResults = $("#container-results").detach();
            gameOver = false;
            wins = 0;
            losses = 0;
            timerCount = 10;
            questCount = 0;
            $("#header").append(container);
            gameStart();
        }

        //Done defining functions

        window.onload = function() {
            $(".answer").on("click", answer);
            // $(".answer").hover(test); //used to test hover
        };

        gameStart();


    </script>
    
</body>

</html>

